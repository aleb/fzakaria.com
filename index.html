<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Farid Zakaria‚Äôs Blog | I‚Äôm a software engineer, father and wishful amateur surfer. If you‚Äôve come seeking my political views; you‚Äôve found the wrong Fareed.</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Farid Zakaria‚Äôs Blog" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I‚Äôm a software engineer, father and wishful amateur surfer. If you‚Äôve come seeking my political views; you‚Äôve found the wrong Fareed." />
<meta property="og:description" content="I‚Äôm a software engineer, father and wishful amateur surfer. If you‚Äôve come seeking my political views; you‚Äôve found the wrong Fareed." />
<link rel="canonical" href="https://fzakaria.com/" />
<meta property="og:url" content="https://fzakaria.com/" />
<meta property="og:site_name" content="Farid Zakaria‚Äôs Blog" />
<link rel="next" href="https://fzakaria.com/page2" />
<script type="application/ld+json">
{"url":"https://fzakaria.com/","headline":"Farid Zakaria‚Äôs Blog","@type":"WebSite","description":"I‚Äôm a software engineer, father and wishful amateur surfer. If you‚Äôve come seeking my political views; you‚Äôve found the wrong Fareed.","name":"Farid Zakaria‚Äôs Blog","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

        <link type="application/atom+xml" rel="alternate" href="https://fzakaria.com/feed.xml" title="Farid Zakaria's Blog" />
        <link rel="stylesheet" type="text/css" href="/assets/css/base.css">
        <link rel="icon" type="image/x-icon" href="/assets/images/avatar.ico">
        <link rel="alternate" type="application/atom+xml" title="Farid Zakaria's Blog" href="/feed.xml">

        <link ref="">

        
        

        
            <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-35360900-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-35360900-1');
</script>

        

    </head>
    <body>
        

        <div class="container">
            <h1 class="page-title">
    <a class="rss pull-right" href="/feed.xml"><i class="fa fa-rss"></i></a>
    Farid Zakaria's Blog
</h1>

<div class="content">
    
    <article>
      <div class="media">
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-08-12
      </span>
      <span class="title">
        
        <a href="/2021/08/12/a-nix-binary-cache-specification.html">A Nix Binary Cache Specification</a>
        
      </span>
    </h2>
    
    <p>I wanted to better understand how to work with Nix binary caches. Interestingly the Nix manual which usually is a great source of knowledge, has <a href="https://nixos.org/manual/nix/unstable/package-management/binary-cache-substituter.html">a very limited section</a> on the Binary Cache.</p>

<blockquote>
  <p>It basically just points you to <a href="https://github.com/edolstra/nix-serve/">nix-serve</a>, a Perl CGI script in <a href="https://github.com/edolstra">Eelco‚Äôs</a> (original author of Nix) personal repository.</p>
</blockquote>

<p>This guide will serve to be a <em>loose</em> Nix Binary Cache specification.
If you are interested in browsing the end result, please checkout my <a href="https://fzakaria.github.io/nix-http-binary-cache-api-spec">OpenAPI Nix HTTP Binary Cache Specification</a> üéÜ</p>

<blockquote>
  <p>You can also visit the GitHub repository <a href="https://github.com/fzakaria/nix-http-binary-cache-api-spec">https://github.com/fzakaria/nix-http-binary-cache-api-spec</a> to contribute.</p>
</blockquote>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-08-10
      </span>
      <span class="title">
        
        <a href="/2021/08/10/investigating-hydration-times-with-nix.html">Investigating hydration times with Nix</a>
        
      </span>
    </h2>
    
    <blockquote>
  <p>üì£ I want a give a huge shoutout to my colleague <a href="https://www.linkedin.com/in/micah-catlin-0718991">Micah Catlin</a>, whose been constantly challenging me on questions on Nix ‚Äì his analytical skills are 11/10. ü§ì</p>
</blockquote>

<p>We are working on a new build system using Nix as the underpinning framework. In order to smooth out the developer experience, we wanted to tackle a very simple question:</p>

<p><em>‚ÄúCan we force developers only to pull from the Nix binary cache?‚Äù</em></p>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-08-05
      </span>
      <span class="title">
        
        <a href="/2021/08/05/the-search-for-a-minimal-nix-shell-continued-mkshellminimal.html">The search for a minimal nix-shell continued; mkShellMinimal</a>
        
      </span>
    </h2>
    
    <blockquote>
  <p>‚ÄúThe simplest things are often the truest.‚Äù - Richard Bach, 1936.</p>
</blockquote>

<p>Earlier <a href="/2021/08/02/a-minimal-nix-shell.html">I wrote about</a> trying to get a minimal nix-shell. The goal and challenge of the post was about reducing the dependency closure size of the shell.</p>

<blockquote>
  <p>I was asked what‚Äôs the point in trying to minimize the closure size ?</p>

  <p>We are using <em>nix-shell</em> in our CI infrastructure and every CI job hydrates it‚Äôs own
<em>/nix/store</em> from scratch. Reducing the dependency closure size would mean faster CI runs. üèéÔ∏è</p>
</blockquote>

<p>The post finished with a question, <em>‚ÄúCan we do better ?‚Äù</em>, to which I answered <em>‚ÄúNo, not at this time.‚Äù</em>.</p>

<p>I‚Äôd like to introduce <a href="https://github.com/NixOS/nixpkgs/pull/132617">mkShellMinimal</a> that does better üéä</p>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-08-02
      </span>
      <span class="title">
        
        <a href="/2021/08/02/a-minimal-nix-shell.html">A minimal nix-shell</a>
        
      </span>
    </h2>
    
    <p>We are currently using <em>nix-shell</em> to create a reproducible environment for our developers and CI infrastructure. Can we minimize the dependency closure to make our CI jobs faster?</p>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-07-31
      </span>
      <span class="title">
        
        <a href="/2021/07/31/eval-the-nix.html">Eval the Nix</a>
        
      </span>
    </h2>
    
    <p>I‚Äôll keep this post short and <em>sweet</em>. I want to write a little blurb that I‚Äôve been mostly enjoying using <strong>nix eval</strong> to introspect.</p>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-06-27
      </span>
      <span class="title">
        
        <a href="/2021/06/27/java-nix-reproducibility.html">Java, Nix & Reproducibility</a>
        
      </span>
    </h2>
    
    <p>I‚Äôve written <em>a lot</em> about NixOS; specifically about some of the work I‚Äôve done to improve the Java ecosystem.</p>

<blockquote>
  <p>In fact, I‚Äôve upstreamed my notes into the <a href="https://nixos.org/manual/nixpkgs/unstable/#maven">Java Maven Nixpkgs documentation</a>.</p>
</blockquote>

<p>üéâ Recently, the minimal ISO for NixOS <a href="https://web.archive.org/web/20210620180034/https://r13y.com/">has become reproducible (r13y)</a>. üéâ</p>

<p>The ability to produce binary reproducible artifacts is a powerful primitive. What does it take for the JVM ecosystem to adopt reproducible builds within the Nix environment?</p>

<blockquote>
  <p>For rationale on the <em>why</em>, please see <a href="https://reproducible-builds.org/">https://reproducible-builds.org/</a></p>
</blockquote>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-06-22
      </span>
      <span class="title">
        
        <a href="/2021/06/22/setting-up-a-nix-google-cloud-storage-gcs-binary-cache.html">setting up a Nix Google Cloud Storage (GCS) binary cache</a>
        
      </span>
    </h2>
    
    <p>A previous post documented how to <a href="/2020/07/15/setting-up-a-nix-s3-binary-cache.html">setup a binary cache directly on S3</a>.
Many however are tied to a different public IaaS offering and may not be able to leverage the native S3 integration Nix offers.
Luckily for those using GCP, Google‚Äôs blob storage equivalent <a href="https://cloud.google.com/storage">Google Cloud Storage (GCS)</a> has <a href="https://cloud.google.com/storage/docs/interoperability">interoperability</a> with the S3 API.</p>

<p>This will allow us to host our binary cache on GCS while still using the native S3 integration in Nix.
Following this guide will allow Nix to leverage GCS without having to use a proxy such as <a href="https://github.com/tweag/nix-store-gcs-proxy">nix-store-gcs-proxy</a>.</p>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2021-03-13
      </span>
      <span class="title">
        
        <a href="/2021/03/13/jruby-and-sorbet.html">JRuby and Sorbet</a>
        
      </span>
    </h2>
    
    <p>A <a href="https://twitter.com/jruby/status/1367170867164295170">recent tweet</a> by the JRuby folks, let me know that the work I had done a while ago to get <a href="https://sorbet.org/">Sorbet</a> working seemed to have gone under the radar.</p>

<blockquote>
  <p>Sorbet is a fast, powerful type checker designed for Ruby.</p>
</blockquote>

<p>I wanted to reflect on it‚Äôs use at our current codebase, challenges still faced and where to go next.</p>

<p>If you want to cut ahead and start using Sorbet right away, I‚Äôve contributed some <a href="https://github.com/sorbet/sorbet/blob/master/docs/JRuby.md">documentation</a>.</p>

    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2020-12-01
      </span>
      <span class="title">
        
        <a href="/2020/12/01/autopatchelf-what-it-can-look-like.html">autopatchelf - what it can look like</a>
        
      </span>
    </h2>
    
    <blockquote>
  <p>This is a follow up post to my previous one to <a href="/2020/11/17/on-demand-linked-libraries-for-nix.html">on-demand linked libraries for NixOS</a>.</p>
</blockquote>

<p>I previously wrote about the work into a new NixOS tool <a href="https://github.com/Mic92/nix-ld">nix-ld</a>, which will allow the possibility of hot-patching the linking of dynamic libraries.</p>

<p>At the moment the goal of the tool is modest in allowing modification of the library search path via a custom environment variable <em>NIX_LD_LIBRARY_PATH</em>.</p>

<blockquote>
  <p>I‚Äôm minimizing the task as there‚Äôs a ton of complexity, such as not loading in a different glibc and other subtleties ‚Äì ask <a href="https://github.com/Mic92">Mic92</a> about it on <a href="irc://irc.freenode.net/#nixos">#nixos</a>!</p>
</blockquote>

<p>I finished with a bit of a <em>teaser</em> on what a full-fledged tool may look like‚Ä¶</p>


    
</div>

		<hr>
	
		<div class="post-stub">
    <h2>
      <span class="date hidden-xs">
        2020-11-17
      </span>
      <span class="title">
        
        <a href="/2020/11/17/on-demand-linked-libraries-for-nix.html">On-demand linked libraries for Nix</a>
        
      </span>
    </h2>
    
    <blockquote>
  <p>This is a write up of some discussion ongoing with some folks on the <a href="irc://irc.freenode.net/nix-community">#nix-community</a> IRC chat primarily being driven by <a href="https://github.com/Mic92">Mic92</a>.</p>
</blockquote>

<p>Nixpkgs maintains the highest rating on <a href="https://repology.org/">Repology</a> for having the most packages &amp; which are up to date. Unfortunately even with the current ecosystem of packages, there will always be gaps, and for beginners in NixOS a common question is:</p>

<p><em>‚ÄúI‚Äôve download a binary and would like to run it on NixOS‚Äù</em></p>

<blockquote>
  <p>Take a look at this graph <a href="https://repology.org/repositories/graphs">https://repology.org/repositories/graphs</a></p>
</blockquote>

<p><img src="/assets/images/repology.svg" alt="repology graph" /></p>

<p><strong>Can we do better &amp; streamline running non-Nix software?</strong> ü§î</p>

<p>This was some of the questions posed by some Nix contributors and I wanted to capture the ideas put forward for others.</p>


    
</div>

		<hr>
	

	

	
    <div class="pull-right">
        <a href="/page2" class="btn btn-primary">
            Page 2
            <span class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512"><path d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"/></svg>
            </span>
        </a>
    </div>
    
</div>
<div class="clearfix"></div>
    </article>
</div>

<div class="sidebar">
    <hr class="visible-xs" />
    <img class="avatar" src="/assets/images/avatar-164.png" alt="A photo of my dog Moose" title="My dog Moose"/>
    <p>I'm a software engineer, father and wishful amateur surfer. If you've come seeking my political views; you've found the wrong <a href="https://fareedzakaria.com/">Fareed</a>.</p>
    <div class="external-links">
      <p>
        <span class="context">linkedin</span>
        <a href="https://www.linkedin.com/in/fmzakari/">fmzakari</a>
      </p>
      <p>
        <span class="context">github</span>
        <a href="https://github.com/fzakaria">fzakaria</a>
      </p>
      <p>
        <span class="context">email</span>
        <a href="mailto:farid.m.zakaria@gmail.com">farid.m.zakaria@gmail.com</a>
      </p>
      <p>
        <span class="context">pgp</span>
        <a href="/publickey.txt">D1B232E7</a>
      </p>
      <p>
        Web friendly version of my <a href="/resume/index.html">resume</a>.
      </p>
    </div>
    <h3>Projects</h3>
    <p>
      <a href="/projects/">Click here</a> for some personal
      projects I've worked on.
    </p>
    <h3>Old Blog</h3>
    <p>
      <a href="/old_blog/">Click here</a> for the archive
      of my old blog posts from Wordpress.
    </p>
    
    <h3>License</h3>
    <p style="font-size: 10pt">
    The content for this site is
    <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>.
    The <a href="https://github.com/SirCmpwn/ddjekyll">inspiration for the theme</a> for this site is
    ¬© Drew Devault.
    </p>
    <div class="spacer" style="margin-top: 30px;"></div>
    
    <p><a href="https://github.com/fzakaria/fzakaria.com/edit/master/index.html">
      Improve this page @ bab8cd6
    </a></p>

</div>
        </div>
    </body>
</html>
